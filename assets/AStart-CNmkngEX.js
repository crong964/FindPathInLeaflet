(function(){"use strict";onmessage=async r=>{var d;let i=JSON.parse(r.data),t={disFin:n(i.sta,i.fin),poi:i.sta,previousPoi:"",previousDis:0},o=new Map;o.set(t.poi,t);let p=new Map,e=t;for(;o.has(i.fin)==!1&&e;)await g(),i.data[e.poi].map(s=>{var c;if(!o.has(s)){if(p.has(s)){let a=p.get(s),l={poi:s,disFin:((c=p.get(s))==null?void 0:c.disFin)||0,previousPoi:e.previousPoi,previousDis:n(s,e.poi)+e.previousDis};a&&l.disFin+l.previousDis<(a==null?void 0:a.disFin)+(a==null?void 0:a.previousDis)&&p.set(s,l)}else p.set(s,{disFin:n(s,i.fin),poi:s,previousPoi:e.poi,previousDis:n(e.poi,s)+e.previousDis}),postMessage(JSON.stringify({type:"nodesize",size:p.size}));postMessage(JSON.stringify({type:"connectWaite",sta:e.poi,fin:s}))}}),e=F(p),e&&(o.set(e.poi,e),p.delete(e.poi));let f=[],u=i.fin;do f.push(u),u=(d=o.get(u))==null?void 0:d.previousPoi;while(u);postMessage(JSON.stringify(f)),close()};function F(r){let i;return r.forEach(t=>{i==null&&(i=t),i.disFin+i.previousDis>t.disFin+t.previousDis&&(i=t)}),i}function n(r,i){let t=r.split(","),o=i.split(",");return Math.sqrt((parseFloat(t[0])-parseFloat(o[0]))**2+(parseFloat(t[1])-parseFloat(o[1]))**2)}function g(){return new Promise(r=>{setTimeout(()=>{r("")},0)})}})();
